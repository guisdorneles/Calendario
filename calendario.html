<html>
<head>
    <script src="js/jquery.js"></script>
    <script src="js/bootstrap-datepicker.js"></script>
    <script src="js/locales/bootstrap-datepicker.pt-BR.min.js"></script>
    <script src="js/bootstrap-datepicker-globalize.js"></script>
    <link rel="stylesheet" href="css/bootstrap-datepicker3.standalone.css">
    <meta charset="utf-8" />
</head>
<body>
    <p>Data Inicio:<input type="text" id="txtDtInicial" />
    <p>Data Fim :<input type="text" id="txtDtFinal" />
    <p>
        Periodo :<input type="text" id="txtPeriodo" onblur="FaixaDatas()" />
        <div id="datepicker" />
    </p>
</body>
</html>

<script type="text/javascript">
    $(document).ready(function () {
        CarregarCalendario(false, 0, 0, 1);
    });

    //Variaveis globais
    //ATENÇÃO: LIMPAR O ARRAY APÓS ENVIAR OS DADOS PARA CONTROLLER
    var listaPeriodoData = new Array();
    var listaData = [];

    function FaixaDatas() {

        CarregarCalendario(true, parseInt($("#txtDtInicial").val()), parseInt($("#txtDtFinal").val()), parseInt($("#txtPeriodo").val()));
    };

    function CarregarCalendario(usarFaixaData, dataInicio, dataFim, periodo) {
        $("#datepicker").datepicker({
            multidate: true,
            format: 'dd/mm/yyyy',
            language: 'pt-BR',
            locale: 'pt-BR'
        });

        if (usarFaixaData) {

            CriarFaixaDatas(dataInicio, dataFim, periodo);
            $('#datepicker').datepicker("destroy");
            var retornoClasse = '';

            $("#datepicker").datepicker({
                multidate: true,
                format: 'dd/mm/yyyy',
                language: 'pt-BR',
                locale: 'pt-BR',
                beforeShowDay: function (date) {
                    var dataCalendario = date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate();

                    if (procurarElementoJsonArray(periodo.toString(), dataCalendario) && periodo == 1) {
                        return 'active periodo1';
                    }
                    else if (procurarElementoJsonArray(periodo.toString(), dataCalendario) && periodo == 2) {
                        return 'active periodo2';
                    }
                    else if (procurarElementoJsonArray(periodo.toString(), dataCalendario) && periodo == 3) {
                        return 'active periodo3';
                    }
                }
            });
        };
    };

    function CriarFaixaDatas(dtInicio, dtFim, periodo) {
        var data = new Date();
        var mes = data.getMonth();
        var ano = data.getFullYear();
        for (var i = dtInicio; i <= dtFim; i++) {
            listaPeriodoData.push({
                "periodo": periodo,
                "data": ano + '-' + parseInt(mes + 1) + '-' + i
            });
            listaData.push(new Date(ano, mes, i));
        }
        return listaPeriodoData;
    };


    function procurarElementoJsonArray(periodo, data) {
        var arrayFiltrado = listaPeriodoData.filter(obj => obj.periodo == periodo && obj.data == data);
        return (arrayFiltrado.length > 0);
    }

    function trimString(s) {
        var l = 0, r = s.length - 1;
        while (l < s.length && s[l] == ' ') l++;
        while (r > l && s[r] == ' ') r -= 1;
        return s.substring(l, r + 1);
    }
</script>