<html>
<head>
    <script src="js/jquery.js"></script>
    <script src="js/bootstrap-datepicker.js"></script>
    <script src="js/locales/bootstrap-datepicker.pt-BR.min.js"></script>
    <script src="js/bootstrap-datepicker-globalize.js"></script>
    <link rel="stylesheet" href="css/bootstrap-datepicker3.standalone.css">
    <meta charset="utf-8" />
</head>
<body>
    <p>Data Inicio:<input type="text" id="txtDtInicial" />
    <p>Data Fim :<input type="text" id="txtDtFinal" />
    <p>
        Periodo :<input type="text" id="txtPeriodo" onblur="FaixaDatas()" />
        <div id="datepicker" />
    </p>
</body>
</html>

<script type="text/javascript">
    $(document).ready(function () {
        CarregarCalendario(false, 0, 0, 1);
    });

    //Variaveis globais
    //ATENÇÃO: LIMPAR O ARRAY APÓS ENVIAR OS DADOS PARA CONTROLLER
    var listaPeriodoData = new Array();
    var listaData = [];

    function FaixaDatas() {

        CarregarCalendario(true, parseInt($("#txtDtInicial").val()), parseInt($("#txtDtFinal").val()), parseInt($("#txtPeriodo").val()));
    };

    function CarregarCalendario(usarFaixaData, dataInicio, dataFim, periodo) {
        $("#datepicker").datepicker({
            multidate: true,
            format: 'dd/mm/yyyy',
            language: 'pt-BR',
            locale: 'pt-BR'
        });

        if (usarFaixaData) {

            CriarFaixaDatas(dataInicio, dataFim, periodo);
            $('#datepicker').datepicker("destroy");
            var retornoClasse = '';

            $("#datepicker").datepicker({
                multidate: true,
                format: 'dd/mm/yyyy',
                language: 'pt-BR',
                locale: 'pt-BR',
                beforeShowDay: function (date) {
                    var dataCalendario = date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate(); 
                    
                    if (procurarElementoJsonArray(periodo.toString(), "periodo") && procurarElementoJsonArray(dataCalendario, 'data')) {
                        return 'active periodo1';  
                    }
                    else if (procurarElementoJsonArray(periodo.toString(), "periodo") && procurarElementoJsonArray(dataCalendario, 'data')) {
                        return  'active periodo2';
                    }
                    else if (procurarElementoJsonArray(periodo.toString(), "periodo") && procurarElementoJsonArray(dataCalendario, 'data')) {
                        return  'active periodo3';                        
                    }
                    return {
                        Classes: retornoClasse
                    };
                }
            });
        };
    };

    function CriarFaixaDatas(dtInicio, dtFim, periodo) {
        var data = new Date();
        var mes = data.getMonth();
        var ano = data.getFullYear();
        for (var i = dtInicio; i <= dtFim; i++) {
            listaPeriodoData.push({
                "periodo": periodo,
                "data": ano + '-' + parseInt(mes + 1) + '-' + i
            });
            listaData.push(new Date(ano, mes, i));
        }
        return listaPeriodoData;
    };


    function procurarElementoJsonArray(elemento, key) {
        var encontrado = false;
        elemento = trimString(elemento); // trim it
        for (var i = 0; i < listaPeriodoData.length; i++) {
                if (listaPeriodoData[i][key].toString().indexOf(elemento) != -1) {
                    encontrado = true;
                }
        }
        return encontrado;
    }

    function trimString(s) {
        var l = 0, r = s.length - 1;
        while (l < s.length && s[l] == ' ') l++;
        while (r > l && s[r] == ' ') r -= 1;
        return s.substring(l, r + 1);
    }

    function compareObjects(o1, o2) {
        var k = '';
        for (k in o1) if (o1[k] != o2[k]) return false;
        for (k in o2) if (o1[k] != o2[k]) return false;
        return true;
    }

</script>